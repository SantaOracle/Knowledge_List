## 1.什么是索引？ ##

&nbsp;&nbsp;索引是一种，用于快速查找指定数据的，数据结构。

&nbsp;&nbsp;你可以把索引类比成书本的目录，我们根据目录进行指定内容的查找，绝大部分情况下会比你逐页查找要快得多

## 2.实现索引的数据结构类型？ ##

&nbsp;&nbsp;索引的数据结构类型和具体的存储引擎有关。

&nbsp;&nbsp;Mysql中使用较多的索引结构由：

- Hash
- B+ Tree

## 3.大致说说这两种索引具体的实现方式？ ##

&nbsp;&nbsp;1）Hash索引：

&nbsp;&nbsp;无非就是一张hash表，这个hash表至少包含两个字段内容：

- 建立索引字段，值的hashCode
- 对应回表的主键

&nbsp;&nbsp;在实际查询时，会先针对该字段条件的指定值进行hash，获取到对应的主键值之后，回表查询对应的记录。

&nbsp;&nbsp;注意，hash索引，在任何情况下，都会回表查询！

&nbsp;&nbsp;2）B+索引：

&nbsp;&nbsp;详细描述请百度，B+ Tree是一个多路平衡查找树，对于某个节点而言，其左子节点的值小于当前节点值，右子节点的值大于当前节点值。叶子节点，每个节点都有指向下一个叶子节点的指针（和B Tree尤为不同的点），方便进行key值遍历

&nbsp;&nbsp;B+树的叶子节点，可能存的是对应记录的主键值，也可能存的是主键值加上整行记录，这取决于存储引擎的实现。

## 4.这两种索引的适用场景？ ##

&nbsp;&nbsp;绝大部分情况下，请使用B+ Tree索引。

&nbsp;&nbsp;仅当需要建立索引的字段满足以下条件时，可以考虑使用Hash索引：

- 仅有等值查询
- 值相同的情况几乎没有（避免hash冲突）

## 5.什么是聚簇索引和非聚簇索引？ ##

&nbsp;&nbsp;这个概念，仅在B+索引下才有。

- 聚簇索引：
    - 一个索引项直接对应实际数据记录的存储页，可谓“直达”
    - 主键缺省使用它
    - 索引项的排序和数据行的存储排序完全一致，利用这一点，想修改数据的存储顺序，可以通过改变主键的方法（撤销原有主键，另找也能满足主键要求的一个字段或一组字段，重建主键）
    - 一个表只能有一个聚簇索引（理由：数据一旦存储，顺序只能有一种）
- 非聚簇索引：
    - 不能“直达”，可能链式地访问多级页表后，才能定位到数据页
    - 一个表可以有多个非聚簇索引

&nbsp;&nbsp;聚簇索引，在InnoDB存储引擎下，可以直接性理解为主键

- 如果设置了主键，那么这个主键就是聚簇索引
- 如果没有设置主键，则挑选一个唯一键作为主键
- 如果没有唯一键，则隐式生成一个键来作为主键

## 6.非聚簇索引一定会回表查询吗？ ##

&nbsp;&nbsp;不一定，如果涉及到的查询语句所要求的查询项在非聚簇索引上全部命中，就不需要回表查询。

&nbsp;&nbsp;回表查询的目的，就是为了在定位了数据位置之后，获取到该条记录上当前还没能获取的字段信息。

&nbsp;&nbsp;举个例子：

```
select age from user where age < 17;
```

&nbsp;&nbsp;如果在age上建立了非聚簇索引，那么这个查询就不会回表查询，因为不需要除了age之外的其他内容。多个非聚簇索引的查询也一样，只要查询的字段全部命中非聚簇索引，就不需要再回表查询。

## 7.建立索引，需要考虑哪些因素？ ##

- 期望建立索引字段，作为条件的使用频率
- 多个字段建立联合索引时，需要考虑各个字段在索引中的顺序，一般高频的在前边，低频的放后边
- 非前缀查询的字段，不需要建立索引

## 8.我的一条查询语句查的很慢，有什么方法可以排查？ ##

&nbsp;&nbsp;使用explain关键字

&nbsp;&nbsp;比如：

```
explain select * from emp where name = 'Jefabc';
```

&nbsp;&nbsp;结果字段的解释如下：

- id:选择标识符
- select_type:表示查询的类型。
- table:输出结果集的表
- partitions:匹配的分区
- type:表示表的连接类型
- possible_keys:表示查询时，可能使用的索引
- key:表示实际使用的索引
- key_len:索引字段的长度
- ref:列与索引的比较
- rows:扫描出的行数(估算的行数)
- filtered:按表条件过滤的行百分比
- Extra:执行情况的描述和说明

## 9.什么情况下，某列创建了索引，但是实际查询时并没有用上？ ##

- 使用 != 进行查询
- 该列参与了数学运算或者函数
- 非前缀查询，如like "%aaa"
- mysql分析，全表扫描的效率比使用索引效率高
- 在使用联合索引时，前面一个条件为范围查询，后面的条件即使符合最左前缀原则，也无法使用索引